---
about_this_resource_text: <p><strong>Topics covered:</strong>&nbsp;Amortized Algorithms,
  Table Doubling, Potential Method</p><p><strong>Instructors:</strong>&nbsp;Prof.
  Erik Demaine,&nbsp;Prof. Charles Leiserson</p>
course_id: 6-046j-introduction-to-algorithms-sma-5503-fall-2005
embedded_media:
- id: lec13.pdf
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-046j-introduction-to-algorithms-sma-5503-fall-2005/video-lectures/lecture-13-amortized-algorithms-table-doubling-potential-method/lec13.pdf
  title: lec13.pdf
  type: null
  uid: 0a02bc84e917b9aeddaf69c8dc151a6f
- id: 6_046J_lec13_th.jpg
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-046j-introduction-to-algorithms-sma-5503-fall-2005/video-lectures/lecture-13-amortized-algorithms-table-doubling-potential-method/6_046J_lec13_th.jpg
  title: 6_046J_lec13_th.jpg
  type: null
  uid: f268646bb678ada03cc98e33151455d7
- id: Video-YouTube-Stream
  media_location: qh5lSHCBiRs
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Video-YouTube-Stream
  type: Video
  uid: 04358a529e6efe56517a082c0dd2c015
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/qh5lSHCBiRs/default.jpg
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 9f05d7aa340d78c19f9f457f11050237
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/id341597754
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Video-iTunes U-MP4
  type: Video
  uid: a22817cd44d12ed8bb157ba6db0fe122
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.046JF05MPEG4/ocw-6.046-31oct2005-220k.mp4
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Video-Internet Archive-MP4
  type: Video
  uid: d0e0f1800e7a4db68b5379f349b96b17
- id: Video-iTunesU-MP3
  media_location: http://deimos3.apple.com/WebObjects/Core.woa/Browse/mit.edu.1298167185.01298167189.1303256338?i=2023865160
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Video-iTunes U-MP3
  type: Video
  uid: 03dcec35de2222c3f75ed2b127e52c43
- id: Video-InternetArchive-MP3
  media_location: http://www.archive.org/download/MIT6.046JF05/ocw-6.046-31oct2005.mp3
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Video-Internet Archive-MP3
  type: Video
  uid: 3935f386b0018edfd044ad1cd54a76eb
- id: Video-VideoLecturesnet-Stream
  media_location: http://videolectures.net/mit6046jf05_introduction_algorithms/
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Video-VideoLectures.net-Stream
  type: Video
  uid: c90dfaf8a4dac27bde3cfdf34b3200d1
- id: Thumbnail-OCW-JPG
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Thumbnail-OCW-JPG
  type: Thumbnail
  uid: 9181250cffccb9924e050680f99d1135
- id: 3Play-3PlayYouTubeid-MP4
  media_location: qh5lSHCBiRs
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 15799952e93bb4a99e9feed2763f8d09
- id: qh5lSHCBiRs.srt
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-046j-introduction-to-algorithms-sma-5503-fall-2005/video-lectures/lecture-13-amortized-algorithms-table-doubling-potential-method/qh5lSHCBiRs.srt
  title: 3play caption file
  type: null
  uid: fc920b641fd5f3fa1fe05848c7a322f6
- id: qh5lSHCBiRs.pdf
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-046j-introduction-to-algorithms-sma-5503-fall-2005/video-lectures/lecture-13-amortized-algorithms-table-doubling-potential-method/qh5lSHCBiRs.pdf
  title: 3play pdf file
  type: null
  uid: 5ef4eab3b8cdbc72f0a8e4209b41c78d
- id: Caption-3Play YouTube id-SRT
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 8696ecc4ba905a0bb5c782a34fee8c35
- id: Transcript-3Play YouTube id-PDF
  parent_uid: 507f17473d5c03b93a67e5ce66f3066d
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 7fa83b259623e007a3ff7a0d73ac26ca
inline_embed_id: 2339042lecture13:amortizedalgorithms,tabledoubling,potentialmethod44586686
layout: video
order_index: null
parent_uid: c492612542f7cc7a09f73790a5f91d81
related_resources_text: <p>Lecture Notes (<a target="_blank" href="./resolveuid/0a02bc84e917b9aeddaf69c8dc151a6f">PDF</a>)<br
  />             <a target="_blank" href="./resolveuid/efc69ef86c18e164d675bd8808c6477a">Assignments</a><br
  />             <a target="_blank" href="./resolveuid/144d9e513546eac8c1fd9b0d278e6eb2">Exams</a></p>
short_url: lecture-13-amortized-algorithms-table-doubling-potential-method
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-046j-introduction-to-algorithms-sma-5503-fall-2005/video-lectures/lecture-13-amortized-algorithms-table-doubling-potential-method
template_type: Tabbed
title: 'Lecture 13: Amortized Algorithms, Table Doubling, Potential Method'
transcript: '<p><span m=''10000''>OK, good morning. So today we are going to,</span>
  <span m=''13000''>as I mentioned last week, we''ve started the part of the</span>
  <span m=''17000''>course where we are doing more things having to do with design</span>
  <span m=''22000''>than purely analysis. Today, we''re actually going to</span> <span
  m=''26000''>do analysis, but it''s the type of analysis that leads to really</span>
  <span m=''32000''>interesting design issues. And we''re going to follow it up</span>
  <span m=''38000''>on Wednesday with an application of the methods we''re going to</span>
  <span m=''46000''>learn today with a really interesting and practical</span> <span
  m=''53000''>problem. So we''re talking today about</span> <span m=''57000''>amortized
  analysis. And I want to motivate this</span> <span m=''64000''>topic by asking the
  question, how large should a hash table</span> <span m=''72000''>be? So, how large
  should a hash</span> <span m=''77000''>table be? Any suggestions?</span> </p><p><span
  m=''80000''>You have got to make a hash table, how big should I make it?</span>
  </p><p><span m=''90000''>Let''s say it''s a simple hash table, resolving collisions
  with</span> <span m=''98000''>chaining. How big should it be?</span> </p><p><span
  m=''103000''>Twice as big as you need: OK, how big would that be?</span> </p><p><span
  m=''110000''>So, twice the number of elements, for example,</span> <span m=''117000''>OK.
  As I increase the size of a</span> <span m=''122000''>hash table, what happens to
  the search time?</span> </p><p><span m=''130000''>What happens to search time as
  I increase the size of the hash</span> <span m=''134000''>table? Yeah, but what
  does it,</span> <span m=''136000''>in general, do you? It decreases,</span> <span
  m=''139000''>right? OK, the bigger I make it,</span> <span m=''141000''>in fact,
  if I make it sufficiently large,</span> <span m=''144000''>then I essentially get
  a direct access table,</span> <span m=''147000''>and everything is worst-case, order
  one time.</span> </p><p><span m=''152000''>So in some sense, we''ll get back to
  your answer</span> <span m=''158000''>in a minute. We should make it as large as</span>
  <span m=''164000''>possible, OK, so that the searching is cheap.</span> </p><p><span
  m=''170000''>The flipside of that is what? It takes a lot of space so I</span> <span
  m=''178000''>should make it as small as possible so as not to waste</span> <span
  m=''185000''>space. So I want it big,</span> <span m=''190000''>and the happy medium,
  as we''ve discussed in our</span> <span m=''198000''>analysis, is to make it order
  n size for n items,</span> <span m=''206000''>OK, because making it larger than
  order n,</span> <span m=''213000''>the payoff in search time is not worth the extra
  amount of</span> <span m=''223000''>space that you are paying. OK, or at least you
  can view it</span> <span m=''231000''>that way. OK, however,</span> <span m=''234000''>this
  begs the question, which is, how do I make it,</span> <span m=''238000''>if I start
  out with a hash table, and I don''t know how many</span> <span m=''244000''>elements
  are going to be hashed into it?</span> </p><p><span m=''249000''>OK, how big should
  I make it? OK, so what if we don''t know --</span> <span m=''274000''>-- in advance?
  OK, what if we don''t know n?</span> </p><p><span m=''279000''>OK, so the solution
  to this problem turns out it''s fairly</span> <span m=''287000''>elegant? It''s
  a strategy called dynamic</span> <span m=''293000''>tables. OK, and the idea is
  that</span> <span m=''298000''>whenever the table gets too many elements in it,</span>
  <span m=''306000''>gets too full, OK, so the idea is --</span> <span m=''326000''>--
  OK, and we say that says the table overflows,</span> <span m=''330000''>OK, we grow
  it and make a bigger table.</span> </p><p><span m=''334000''>So, for hashing, although
  there''s going to be no</span> <span m=''338000''>point at which you could say that
  it overflows in the sense</span> <span m=''344000''>that it wouldn''t be functional
  at least if it was done with</span> <span m=''349000''>chaining. There would be,</span>
  <span m=''352000''>by the way, if you were doing it with open addressing.</span>
  </p><p><span m=''357000''>But let''s say with chaining, when it gets too big,</span>
  <span m=''361000''>say, as many elements as the size of the table,</span> <span
  m=''366000''>what we do is we grow the table.</span> </p><p><span m=''371000''>So,
  the way we do that as we allocate using,</span> <span m=''376000''>in a language
  like C, it''s called Malloc,</span> <span m=''382000''>or in a language like Java
  called New, a larger table.</span> </p><p><span m=''390000''>So, we create a larger
  table. We move the items from the old</span> <span m=''403000''>table to the new.
  And then, we free the old</span> <span m=''413000''>table. So, let''s do an example.</span>
  </p><p><span m=''421000''>So, let''s say I have, over here, a table of size one,</span>
  <span m=''425000''>and it''s empty to begin with. And I do an insert.</span> </p><p><span
  m=''429000''>So what I do is stick it in the table.</span> </p><p><span m=''432000''>It
  fits. OK, so here,</span> <span m=''434000''>I''m not going to do it with hashing.</span>
  </p><p><span m=''437000''>I''m just going to do it as if I just had a table that
  I was</span> <span m=''442000''>filling up with elements to abstract the problem.</span>
  </p><p><span m=''446000''>But it would work with hashing. It would work with any
  kind of</span> <span m=''453000''>fixed size data structure. I insert again,</span>
  <span m=''458000''>oops, doesn''t fit. I get an overflow.</span> </p><p><span m=''462000''>OK,
  so what I do is I create a new, actually,</span> <span m=''468000''>I''m going to
  need a little more space than that.</span> </p><p><span m=''473000''>I create a
  new table of size two, doubling the size.</span> </p><p><span m=''481000''>And,
  I copy the old value into the new.</span> </p><p><span m=''486000''>I freed this
  one, and now I can insert item two.</span> </p><p><span m=''493000''>So, I do it
  again. I get another overflow.</span> </p><p><span m=''499000''>So now, I make a
  table of size four.</span> </p><p><span m=''504000''>I copied these guys in, and
  then I insert my number</span> <span m=''511000''>three. I do insert here.</span>
  </p><p><span m=''516000''>I do five. I guess I should be using ditto</span> <span
  m=''521000''>marks. That would be a lot smarter.</span> </p><p><span m=''526000''>Whoops,
  what am I doing? I overflow.</span> </p><p><span m=''532000''>And now, I make one
  of size eight, OK, copy these over,</span> <span m=''540000''>and now I can insert
  five. And I can do six,</span> <span m=''547000''>seven, etc., OK?</span> </p><p><span
  m=''549000''>Does everybody understand the basic idea?</span> </p><p><span m=''555000''>So,
  whenever I overflow, I''m going to create a table of</span> <span m=''564000''>twice
  the size. OK, so let''s do a quick</span> <span m=''570000''>analysis of this. So,
  we have a sequence of n</span> <span m=''579000''>insertion operations. OK, what
  is the worst-case cost</span> <span m=''589000''>of one insert operation? What''s
  the worst case for any</span> <span m=''598000''>one of these? Yeah, it''s order
  n,</span> <span m=''604000''>whatever the overhead is of copying; if we counted
  it as</span> <span m=''610000''>one, it would be basically n or n plus one because
  we''ve got to</span> <span m=''617000''>copy all those. OK, so it''s order n.</span>
  </p><p><span m=''621000''>So therefore, if I have n of those,</span> <span m=''625000''>so
  the worst-case cost of n inserts is equal to n times</span> <span m=''631000''>order
  n, which is order n^2.</span> </p><p><span m=''644000''>Any questions? Does that
  make sense?</span> </p><p><span m=''654000''>Raise hands.</span> </p><p><span m=''675000''>Yeah,
  not all of them can be worst-case, good.</span> </p><p><span m=''679000''>And in
  fact, this is totally wrong analysis.</span> </p><p><span m=''684000''>Just because
  one can be worst-case order n doesn''t mean</span> <span m=''689000''>n are necessarily
  order n. OK, so this is totally wrong</span> <span m=''695000''>analysis. n inserts,
  in fact,</span> <span m=''698000''>take order n time in the worst case.</span> </p><p><span
  m=''703000''>OK, it doesn''t take order n^2. So, the analysis is correct up</span>
  <span m=''708000''>to the point where we set the worst-case of one insert was</span>
  <span m=''712000''>order n. Therefore, that''s the wrong</span> <span m=''715000''>step.
  OK, whenever you see bugs in</span> <span m=''718000''>proofs, you want to know,
  which step is the one that</span> <span m=''722000''>failed so you can make sure
  that you don''t have a confusion</span> <span m=''727000''>there? So, let''s do
  the proper</span> <span m=''733000''>analysis, OK? So let''s let c_i be the cost
  of</span> <span m=''743000''>the i''th insert. OK, so that''s equal to i,</span>
  <span m=''752000''>if i minus one is an exact power of two.</span> </p><p><span
  m=''762000''>And it''s one otherwise. OK, so as I was going through</span> <span
  m=''767000''>here, it was only when I inserted something where the</span> <span
  m=''772000''>previous one had been the exact power of two,</span> <span m=''776000''>because
  that was my table size. That''s when I got the overflow</span> <span m=''783000''>and
  had to do all that copying. And otherwise,</span> <span m=''789000''>the cost, for
  example, for inserting six,</span> <span m=''793000''>was just one. I just inserted
  it.</span> </p><p><span m=''797000''>Does everybody see that? So, let''s actually
  make a</span> <span m=''803000''>little table here so we can see this a little bit
  more clearly.</span> </p><p><span m=''811000''>OK, so here''s i, and in the size
  of the table at</span> <span m=''816000''>step i, and the cost at step i. OK, so
  let''s see,</span> <span m=''823000''>the size of i, let''s see, at step one it
  was</span> <span m=''828000''>one. At step two,</span> <span m=''830000''>it was
  two. And at step three,</span> <span m=''833000''>that''s when, to get three in
  the table,</span> <span m=''837000''>we had to double the size here. So, this is
  four,</span> <span m=''843000''>and four, it fit. And then five,</span> <span m=''846000''>it
  had to bump up to eight. And then, six,</span> <span m=''849000''>it was eight.
  Seven, it was eight.</span> </p><p><span m=''852000''>Eight, it was eight. And nine,
  it bumps up to 16,</span> <span m=''856000''>16, etc. So that''s the size.</span>
  </p><p><span m=''859000''>And let''s take a look at what the cost was.</span> </p><p><span
  m=''862000''>So, the cost here was one, OK, to insert one.</span> </p><p><span m=''866000''>The
  cost here was, I had to copy one,</span> <span m=''869000''>and then insert one.
  So, the cost was two.</span> </p><p><span m=''875000''>Here, I had to copy two and
  insert one.</span> </p><p><span m=''878000''>So, the cost was three. Here, I had
  to just insert one.</span> </p><p><span m=''884000''>So, the cost was one. Here,
  I had to copy four and</span> <span m=''889000''>insert one. So, the cost was five.</span>
  </p><p><span m=''892000''>Excuse me? I think it is.</span> </p><p><span m=''895000''>Yeah,
  see, it''s i cost. The cost for five is i,</span> <span m=''899000''>OK, is five
  if this is a power of two.</span> </p><p><span m=''905000''>OK, one, one, and now
  we paid nine,</span> <span m=''907000''>and then one again. So that''s the cost
  we are</span> <span m=''911000''>paying. It''s a little bit easier to see</span>
  <span m=''915000''>what the costs are if I break them down.</span> </p><p><span
  m=''918000''>OK, so let''s just redraw this as two values because there is</span>
  <span m=''923000''>always the cost for inserting the one thing that I want to</span>
  <span m=''928000''>insert. And now, the residual amount</span> <span m=''932000''>that
  I have to pay is I have to pay one here.</span> </p><p><span m=''935000''>I''ve
  got to pay two additional, four additional,</span> <span m=''938000''>eight additional.
  That makes the pattern a little</span> <span m=''942000''>bit easier to see. OK,
  this is the cost of copying</span> <span m=''945000''>versus the cost of just doing
  the actual insert,</span> <span m=''949000''>OK? Now, if you''re taking notes,</span>
  <span m=''951000''>leave some space here because I''m going to come back to this</span>
  <span m=''955000''>table later. OK, so leave a little bit of</span> <span m=''958000''>space
  because I''m going to come back and add some more things at</span> <span m=''963000''>there
  at a later time. OK, so, I can then just add up</span> <span m=''969000''>the cost
  of n inserts. That''s just the sum,</span> <span m=''974000''>I equals one to n
  of c_i, which is equal to,</span> <span m=''980000''>well, by this analysis it is
  essentially n because that''s</span> <span m=''987000''>what this thing adds up
  to plus I just have to add the powers of</span> <span m=''995000''>two up to but
  not exceeding whatever my n was.</span> </p><p><span m=''1002000''>So, if I do my
  algebra properly there, that''s up to the floor of</span> <span m=''1010000''>log
  n minus one, OK, of two to the J.</span> </p><p><span m=''1015000''>So, I''m just
  adding up all the powers of two up to that aren''t</span> <span m=''1023000''>going
  to exceed my n. And, this is what type of</span> <span m=''1029000''>series? That''s
  geometric.</span> </p><p><span m=''1032000''>That''s geometric, so it is bounded
  by its largest</span> <span m=''1038000''>term. Its largest term is two to the</span>
  <span m=''1042000''>ceiling; it''s dominated by its largest term,</span> <span m=''1047000''>two
  to the ceiling of log n minus one, which is,</span> <span m=''1052000''>at most,
  n. OK, and then all the other</span> <span m=''1058000''>terms at up to, at most,
  n.</span> </p><p><span m=''1061000''>So this is actually less than or equal to 3n,</span>
  <span m=''1067000''>which is order n as we want it to show.</span> </p><p><span
  m=''1071000''>OK, that''s algebra. OK, so, thus,</span> <span m=''1077000''>the
  average cost per insert is theta of n over n,</span> <span m=''1085000''>which is
  theta one. So, the average cost of an</span> <span m=''1092000''>insert is order
  one, which is what we would like it</span> <span m=''1101000''>to be especially
  if we''re building hash tables.</span> </p><p><span m=''1110000''>Even though sometimes
  you have to pay a big price with</span> <span m=''1114000''>amortized over the previous
  insertions that we''ve done,</span> <span m=''1118000''>so that the overall cost
  of n operations is order n.</span> </p><p><span m=''1122000''>And that''s the notion
  of amortized analysis,</span> <span m=''1126000''>OK, that if I look at a sequence
  of operations,</span> <span m=''1130000''>I can spread the cost out over a whole
  bunch of operations,</span> <span m=''1135000''>so that the average cost is order
  n.</span> </p><p><span m=''1139000''>So, if we sort of summarize that, OK, OK,</span>
  <span m=''1147000''>with basically an amortized analysis, we analyze a sequence</span>
  <span m=''1160000''>of operations to show that the average cost per operation is</span>
  <span m=''1174000''>small, even though one operation, or several,</span> <span m=''1184000''>even,
  may be expensive. OK, there''s no probability.</span> </p><p><span m=''1199000''>Even
  though we''re doing it with averages, there''s no probability</span> <span m=''1205000''>going
  on. OK, what you do probability,</span> <span m=''1208000''>and you are looking
  at means, there''s averages.</span> </p><p><span m=''1213000''>OK, here''s average,
  but there''s no probability</span> <span m=''1217000''>going on. It''s average performance
  in the</span> <span m=''1221000''>worst case because n operations take me a constant
  amount of</span> <span m=''1227000''>time per operation in the worst case.</span>
  </p><p><span m=''1231000''>n operations take me order n time.</span> </p><p><span
  m=''1236000''>OK, each operation takes order one time, OK,</span> <span m=''1242000''>but
  it''s amortized over the n operations, OK?</span> </p><p><span m=''1249000''>Yeah,
  question? Yes.</span> </p><p><span m=''1252000''>Yes, yes, you can mix, but you
  don''t have to.</span> </p><p><span m=''1260000''>Yeah, but the point is that the
  basic amortized analysis is</span> <span m=''1266000''>actually saying something
  very strong.</span> </p><p><span m=''1270000''>It''s giving you worst-case bounds,
  but over a sequence as</span> <span m=''1276000''>opposed to looking at each individual
  element of the</span> <span m=''1281000''>sequence. Now, there are three types of</span>
  <span m=''1285000''>amortized arguments that appear in the literature.</span> </p><p><span
  m=''1292000''>Maybe there are more. At one point,</span> <span m=''1295000''>there
  were two. And then, a third one was</span> <span m=''1299000''>developed. So, maybe
  there''s a fourth.</span> </p><p><span m=''1303000''>The first one is an aggregate,
  what''s called an aggregate</span> <span m=''1309000''>analysis. And this is what
  we just saw,</span> <span m=''1313000''>OK, where basically you just analyze, what
  do the n</span> <span m=''1319000''>operations take? OK, and then we''re going to
  see</span> <span m=''1328000''>two more today. One is called an accounting</span>
  <span m=''1336000''>argument, and the other is a potential argument.</span> </p><p><span
  m=''1345000''>These two are more precise because they allocate specific</span> <span
  m=''1356000''>amortized costs to each operation.</span> </p><p><span m=''1365000''>So,
  one of the things about the aggregate analysis is that you</span> <span m=''1369000''>can''t
  really say what the amortized cost of a single</span> <span m=''1373000''>operation
  is easily. You can in this case.</span> </p><p><span m=''1377000''>You can say it''s
  order one, OK?</span> </p><p><span m=''1380000''>But, in the accounting and potential
  arguments,</span> <span m=''1383000''>it gives you a much more precise way of characterizing</span>
  <span m=''1387000''>what an amortized cost of a particular operation is.</span>
  </p><p><span m=''1391000''>So, let''s pitch in and look at the accounting method
  as our</span> <span m=''1396000''>first method. So, these we''re going to go</span>
  <span m=''1399000''>through the exact same example. In some sense,</span> <span
  m=''1402000''>this example, the easiest argument to make is</span> <span m=''1405000''>the
  aggregate analysis. OK, so we''re going get into</span> <span m=''1409000''>arguments
  that, in some sense,</span> <span m=''1412000''>see more complicated. But it turns
  out that these</span> <span m=''1417000''>methods are more powerful in many circumstances.</span>
  </p><p><span m=''1423000''>OK, and so I want to do it in a simple situation where
  you have</span> <span m=''1429000''>some sort of appreciation of the fact that you
  can look at any</span> <span m=''1436000''>particular problem and approach it from
  different ways.</span> </p><p><span m=''1442000''>OK, so the accounting method is
  putting yourself in the position</span> <span m=''1448000''>of a financial accountant.
  So what you do is we are going</span> <span m=''1459000''>to charge the i''th operation
  a fictitious amortized cost.</span> </p><p><span m=''1473000''>We''ll call it c
  hat sub i, where we are going to use the</span> <span m=''1479000''>abstraction
  that $1 pays for one unit of work.</span> </p><p><span m=''1484000''>There''s Time
  manipulating the data structure or whatever.</span> </p><p><span m=''1491000''>OK,
  so the idea is you charge the cost.</span> </p><p><span m=''1495000''>You say, this
  operation will cost you $5 or whatever.</span> </p><p><span m=''1503000''>OK, and
  that phi is consumed to perform the operation,</span> <span m=''1514000''>but there
  may be some unused part.</span> </p><p><span m=''1521000''>So, if there''s any unused
  amount, it''s going to be stored</span> <span m=''1533000''>in the bank for use
  by later operations.</span> </p><p><span m=''1544000''>So the idea is that if the
  phi that is being paid,</span> <span m=''1549000''>the c_i hat phi, isn''t sufficient
  to pay for</span> <span m=''1554000''>performing the operation, then you take money
  out of the</span> <span m=''1561000''>bank to pay for it. OK, and so you don''t
  get</span> <span m=''1565000''>arrested, what''s the property that you''ve got to
  have?</span> </p><p><span m=''1569000''>You''ve got to have the bank balance.</span>
  </p><p><span m=''1572000''>What about the bank balance? What mathematical fact has
  to</span> <span m=''1576000''>hold the bank balance? Yeah, it better be greater
  than</span> <span m=''1580000''>or equal to zero, right?</span> </p><p><span m=''1582000''>Most
  people are familiar with that.</span> </p><p><span m=''1586000''>So, the bank balance
  must not go negative.</span> </p><p><span m=''1590000''>In other words, the amortized
  costs minus the</span> <span m=''1595000''>costs of the operations up to that point
  have to always be</span> <span m=''1601000''>enough to pay for all the operations
  that you''re doing.</span> </p><p><span m=''1606000''>Otherwise, you''re borrowing
  on the future.</span> </p><p><span m=''1611000''>In amortized analysis, we don''t
  borrow on the future,</span> <span m=''1616000''>at least not on the simple ones
  that we are doing here.</span> </p><p><span m=''1624000''>OK, so that means we must
  have that the sum,</span> <span m=''1631000''>I equals one to n of c_i, the true
  costs,</span> <span m=''1639000''>therefore, if the balance is not going to ever
  go negative,</span> <span m=''1649000''>must be bounded above by the amortized costs
  for all n.</span> </p><p><span m=''1661000''>OK, for the bank balance not to go
  negative, if I add up the</span> <span m=''1665000''>true costs, it''s got to be
  the case that I can always pay for</span> <span m=''1669000''>them. This is what
  I''m charging.</span> </p><p><span m=''1671000''>This is what it actually costs
  me.</span> </p><p><span m=''1674000''>So, it better be the case that whatever I''ve
  actually had to</span> <span m=''1678000''>pay to operate on that data structure,
  that''s what this is,</span> <span m=''1682000''>better be covered by the amount
  that I''ve been charging people</span> <span m=''1687000''>for the use of that data
  structure up to that point.</span> </p><p><span m=''1692000''>And that''s got to
  be true for all n.</span> </p><p><span m=''1695000''>But notice that this now gives
  me a way of charging a</span> <span m=''1699000''>particular operation a certain
  amount.</span> </p><p><span m=''1703000''>So, the total amortized costs provide
  an upper bound on the</span> <span m=''1708000''>total true costs. Total amortized
  costs are an</span> <span m=''1715000''>upper bound on the true costs. Any question
  about this?</span> </p><p><span m=''1725000''>That we''ll do the example of the
  dynamic table using this</span> <span m=''1734000''>methodology. OK, so, back to
  the dynamic</span> <span m=''1741000''>table. OK, so what we''re going to do</span>
  <span m=''1748000''>in this case is we''re going to charge an amortized cost of
  $3</span> <span m=''1759000''>for the i''th insert for all i. And the idea is that
  $1 is</span> <span m=''1771000''>going to pay for an immediate insert, and $2 is
  going to be</span> <span m=''1785000''>stored for doubling the table. And, it needs
  to be expanded.</span> </p><p><span m=''1800000''>When the table doubles, of the
  stored dollars,</span> <span m=''1810000''>we''ll use one dollar to move a recent
  item, I''ll call it,</span> <span m=''1824000''>and one dollar we''ll move an old
  item.</span> </p><p><span m=''1834000''>So, let''s do the example. So, imagine that
  I''m in this</span> <span m=''1842000''>situation where I have a table of size eight,</span>
  <span m=''1849000''>and I just doubled my table. So I have four items of the</span>
  <span m=''1857000''>table. What I''m going to do is have no</span> <span m=''1863000''>dollars
  in my table. So, along comes an insertion of</span> <span m=''1871000''>item number
  five. I charge $3 for it.</span> </p><p><span m=''1876000''>$1 lets me put the item
  in the table, and I have $2 left over.</span> </p><p><span m=''1883000''>So let
  me store those $2 in the slot corresponding to where that</span> <span m=''1891000''>item
  is. Now, item six comes in.</span> </p><p><span m=''1894000''>Once again, $1, charge
  $3, $1 is paid for the</span> <span m=''1898000''>insert, $2 left over, I''m going
  to play $2.</span> </p><p><span m=''1902000''>Let me put it down there, and so forth.</span>
  </p><p><span m=''1905000''>The next one comes in, $2, $2 leftover,</span> <span
  m=''1908000''>and now the ninth item comes in.</span> </p><p><span m=''1911000''>So,
  I double the size of my table.</span> </p><p><span m=''1928000''>OK, and now I copy
  all of these guys and to all of these here.</span> </p><p><span m=''1933000''>And
  what happens? Look at that:</span> <span m=''1935000''>I''ve got $8, and I''ve got
  eight items that</span> <span m=''1939000''>have to be copied. Perfect.</span> </p><p><span
  m=''1941000''>OK, so one of these dollars pays for one of the ones that</span> <span
  m=''1946000''>was inserted in the last round, and one of them pays for an old</span>
  <span m=''1951000''>one. OK, and so, I copy them in,</span> <span m=''1955000''>and
  now, none of those guys have any money.</span> </p><p><span m=''1960000''>And the
  ninth guy comes in: he has $2 left over.</span> </p><p><span m=''1965000''>And then,
  we keep going on. OK, so you see that by that</span> <span m=''1970000''>argument,
  if I charge everybody $3, OK, I can always handle all</span> <span m=''1977000''>of
  the table doubling, the charges for the table</span> <span m=''1981000''>doubling
  because the inductive invariant that I''ve maintained</span> <span m=''1988000''>is
  that after it doubles, there''s nothing in the bank</span> <span m=''1993000''>account.
  And now, I put in $2.</span> </p><p><span m=''1997000''>Well then, I can pay, and
  I''m now left in the same</span> <span m=''2001000''>situation. OK, and it''s the
  case that the</span> <span m=''2004000''>bank balance never goes negative.</span>
  </p><p><span m=''2006000''>So that''s a really important invariant to verify.</span>
  </p><p><span m=''2021000''>And so, therefore, the sum of the true costs,</span>
  <span m=''2026000''>or the amortized costs, upper bound the sum of the true</span>
  <span m=''2033000''>costs. And, since the sum of the</span> <span m=''2037000''>amortized
  cost, here, is, if I go i equals one</span> <span m=''2043000''>to n, OK, this is
  3n. So, the point is,</span> <span m=''2049000''>now I bounded the sum of the true
  costs by 3n.</span> </p><p><span m=''2056000''>OK, so let''s go back to this table
  here, and look to see what</span> <span m=''2065000''>happens, OK, if I put in c_i
  hat, and the bank balance.</span> </p><p><span m=''2075000''>OK, so in fact, so
  the first thing I do is</span> <span m=''2083000''>insert; I charge $3, right, and
  I do an insert.</span> </p><p><span m=''2093000''>How much do I have left? I''m
  going to have $2.</span> </p><p><span m=''2101000''>It turns out I''m actually going
  to charge $2 and have only $1</span> <span m=''2107000''>left. OK, so I''m actually
  going to</span> <span m=''2110000''>under charge the first guy. I''m going to show
  you that it</span> <span m=''2116000''>works if I charge everybody $3. Except the
  first guy:</span> <span m=''2121000''>I charge $2. I can actually save a little</span>
  <span m=''2125000''>bit on number one. OK, that for this guy I''m going</span> <span
  m=''2130000''>to charge $3. OK, what''s the size of my bank</span> <span m=''2136000''>balance
  when I''m done? Well, I have to copy one guy.</span> </p><p><span m=''2142000''>He''s
  all paid for, so I have $2 left.</span> </p><p><span m=''2147000''>OK, people with
  me? OK, the next guy:</span> <span m=''2151000''>I charge $3. Actually, I''m going
  to charge</span> <span m=''2156000''>all these guys $3. OK, so here now I basically
  get</span> <span m=''2162000''>to, I''ve got a table of size four.</span> </p><p><span
  m=''2166000''>So, I basically have, I have to copy,</span> <span m=''2169000''>oh,
  when I insert the third guy, I''ve got to copy two guys.</span> </p><p><span m=''2174000''>That''ll
  use up that, so I''ll have only $2 left in</span> <span m=''2179000''>the table
  after I''ve inserted him.</span> </p><p><span m=''2182000''>OK, now I insert the
  fourth guy, OK, and that''s a good one</span> <span m=''2187000''>because now I''ve
  built up a balance here of $4 because I</span> <span m=''2192000''>didn''t have
  to copy anybody. OK, now I insert the fifth guy.</span> </p><p><span m=''2201000''>I''ve
  got to copy four items. So that expends that balance.</span> </p><p><span m=''2210000''>I
  have, then, two left.</span> </p><p><span m=''2214000''>OK, and then here basically
  I add two to it.</span> </p><p><span m=''2220000''>And then at this point, I use
  it all up and go back to</span> <span m=''2229000''>two, etc. OK, so you see one
  of the</span> <span m=''2233000''>things I want you to notice is I could have charged
  three here.</span> </p><p><span m=''2238000''>And then I would''ve had an extra
  dollar lying around</span> <span m=''2242000''>throughout here. It wouldn''t have
  mattered.</span> </p><p><span m=''2245000''>It still would be upper bounded by 3n.</span>
  </p><p><span m=''2248000''>OK, so the idea is that different schemes for charging</span>
  <span m=''2252000''>amortized costs can work. They don''t all have to be the</span>
  <span m=''2256000''>same. It''s not like when you do in</span> <span m=''2259000''>amortized
  analysis that there is one scheme that will work.</span> </p><p><span m=''2263000''>I
  could have charged $4 to everybody.</span> </p><p><span m=''2265000''>And it would
  have worked. But it turns out,</span> <span m=''2268000''>I couldn''t have charged
  two dollars for everybody.</span> </p><p><span m=''2271000''>If I charged $2 for
  everybody, my balance would go negative,</span> <span m=''2275000''>OK? My balance
  would go negative,</span> <span m=''2277000''>but I can charge three dollars, and
  that will work.</span> </p><p><span m=''2282000''>OK, four, five, six, I could charge
  that.</span> </p><p><span m=''2284000''>The bound that I would get would be simply
  a looser bound.</span> </p><p><span m=''2288000''>Instead of it being less than
  or equal to 3n,</span> <span m=''2291000''>it would be less than or equal to 4n
  or 5n, or what have you.</span> </p><p><span m=''2295000''>But if I tried to do
  2n, it wouldn''t have worked because</span> <span m=''2299000''>I wouldn''t have
  enough money left to copy everything.</span> </p><p><span m=''2302000''>What would
  happen is I would have only $1 in this,</span> <span m=''2305000''>and then when
  it came time to table double,</span> <span m=''2308000''>I would need to copy eight
  guys.</span> </p><p><span m=''2310000''>And I''d only have built up a bank account
  of $4,</span> <span m=''2313000''>sorry, if I charged $2 and had $1 left over.</span>
  </p><p><span m=''2318000''>OK, so to actually make these things work out,</span>
  <span m=''2322000''>you have to play a little bit, OK, see what works,</span> <span
  m=''2327000''>see what doesn''t work. OK, no algorithmic formulas for</span> <span
  m=''2333000''>algorithm design. OK, good.</span> </p><p><span m=''2335000''>In the
  book, you can read about table</span> <span m=''2339000''>contraction. What happens
  when you start</span> <span m=''2343000''>deleting elements? Now you want to make
  the table</span> <span m=''2346000''>be smaller. Now, you have to be very</span>
  <span m=''2349000''>careful because unless you put, who remembers from physics,</span>
  <span m=''2352000''>hysteresis? Vaguely?</span> </p><p><span m=''2353000''>A couple
  people? OK, you have to worry about</span> <span m=''2356000''>hysteresis. OK, if
  you''re not careful,</span> <span m=''2358000''>if whenever it gets to be less than
  a power of two,</span> <span m=''2362000''>you go in the half, you can find that
  you''re</span> <span m=''2364000''>thrashing. So, you need to make it so that</span>
  <span m=''2367000''>there is some memory in the system so that you only collapse</span>
  <span m=''2371000''>after you''ve done a sufficient number of deletions,</span>
  <span m=''2374000''>OK, and so forth. And the book has analysis of</span> <span
  m=''2379000''>the more general case. OK, so any questions about the</span> <span
  m=''2383000''>accounting method? Accounting method is really</span> <span m=''2386000''>very
  cute, OK, very cute.</span> </p><p><span m=''2388000''>And, it''s the one most students
  prefer to do,</span> <span m=''2391000''>OK? They usually hate the next one</span>
  <span m=''2394000''>until they learn it. Once they learn it,</span> <span m=''2396000''>they
  say, ooh, that''s cool.</span> </p><p><span m=''2400000''>OK, but to start out with,
  it takes a little bit more</span> <span m=''2404000''>intestinal fortitude, OK?</span>
  </p><p><span m=''2407000''>But it''s amazing. Good potential arguments are</span>
  <span m=''2411000''>really sweet. And we are going to see one</span> <span m=''2415000''>next
  time, so you''ll definitely want to review and make sure you</span> <span m=''2420000''>understand
  it before Wednesday''s lecture because Wednesday''s</span> <span m=''2426000''>lecture,
  we''re going to assume we understand potential method.</span> </p><p><span m=''2432000''>OK,
  so let''s do, enough advertisement.</span> </p><p><span m=''2437000''>I think the
  potential method is one of the beautiful results in</span> <span m=''2443000''>algorithmic
  analysis, OK, just beautiful result,</span> <span m=''2448000''>beautiful set of
  techniques. OK, and it''s also,</span> <span m=''2452000''>just in terms of, I mean,
  what do you aspire:</span> <span m=''2457000''>to be a bookkeeper or to be a physicist?</span>
  </p><p><span m=''2462000''>OK, so, the idea is we don''t want to be bankers.</span>
  </p><p><span m=''2470000''>We want to be physicists.</span> </p><p><span m=''2484000''>And
  so, this bank account, we are going to say about the</span> <span m=''2488000''>potential
  energy of the dynamics that that we are analyzing.</span> </p><p><span m=''2492000''>OK,
  because, why?</span> </p><p><span m=''2494000''>It delivers up work just like a
  spring does, for example,</span> <span m=''2498000''>OK, when you study potential
  energy, or putting something up</span> <span m=''2502000''>high and having gravity
  pull it down.</span> </p><p><span m=''2505000''>We convert dynamic to potential,
  and that''s exactly</span> <span m=''2509000''>what we''re going to be doing here,
  and it''s similar</span> <span m=''2513000''>mathematics except that in our case
  it turns out to be discrete</span> <span m=''2518000''>mathematics rather than continuous
  math for most of it.</span> </p><p><span m=''2524000''>So here''s the framework
  for the potential method.</span> </p><p><span m=''2534000''>So, we start with some
  data structure, D_0,</span> <span m=''2543000''>and operation i transforms D_(i
  - 1) into D_i.</span> </p><p><span m=''2555000''>So, we view the operation on the
  data structure as a mapping,</span> <span m=''2560000''>mapping one data structure
  to another data structure,</span> <span m=''2565000''>the one from before to the
  one after.</span> </p><p><span m=''2568000''>OK, already it''s nicely mathematical.</span>
  </p><p><span m=''2571000''>OK, and of course, the costs of operation i</span> <span
  m=''2575000''>remains at c_i.</span> </p><p><span m=''2594000''>And, now what we
  are going to do is define the potential</span> <span m=''2606000''>function, phi,
  which maps the set of data</span> <span m=''2615000''>structures into the reals.
  So, associated with every data</span> <span m=''2626000''>structure, now, is a potential,</span>
  <span m=''2631000''>OK, a real-valued potential, often integer potential such</span>
  <span m=''2640000''>that phi of D_0 is equal to zero.</span> </p><p><span m=''2646000''>So,
  the initial potential is zero, and phi of D_i is greater</span> <span m=''2651000''>than
  or equal to zero for all i. So, potential can never be</span> <span m=''2656000''>nonnegative,
  just like the bank account because the potential is</span> <span m=''2662000''>essentially
  representing the bank account,</span> <span m=''2665000''>if you will, in the accounting
  method.</span> </p><p><span m=''2669000''>OK, so we always want the potential to
  be nonnegative.</span> </p><p><span m=''2675000''>Now, actually, there are times
  where you use</span> <span m=''2677000''>potential functions where you violate both
  of these</span> <span m=''2680000''>properties. There''s some really interesting</span>
  <span m=''2683000''>potential arguments which don''t violate like these,</span>
  <span m=''2686000''>but for the simple ones we''re going to be doing in this class,</span>
  <span m=''2690000''>we''ll just assume that these tend to be true.</span> </p><p><span
  m=''2692000''>OK, but we will actually see some times where phi of D_0</span> <span
  m=''2696000''>isn''t zero, it doesn''t matter. OK, but generally this is what</span>
  <span m=''2700000''>we are going to assume in the type of potential function</span>
  <span m=''2703000''>argument that we are going to be doing.</span> </p><p><span
  m=''2707000''>OK, so I just want to let you know that there are bigger,</span> <span
  m=''2712000''>there is a bigger space of potential function arguments</span> <span
  m=''2718000''>than the one that I''m showing you here.</span> </p><p><span m=''2722000''>OK,
  so then, under this circumstance,</span> <span m=''2725000''>we define the amortized
  cost c_i hat with respect to phi as,</span> <span m=''2731000''>and this is one
  of these formulas that if you can''t</span> <span m=''2736000''>remember it, definitely
  put it down on your crib sheet for the</span> <span m=''2742000''>final. OK, so
  c_i hat is equal to c_i</span> <span m=''2751000''>plus phi of D_i minus phi of
  D_i minus one.</span> </p><p><span m=''2761000''>OK, so this is the change in potential
  difference.</span> </p><p><span m=''2772000''>And, let''s call it delta phi i for
  shorthand.</span> </p><p><span m=''2782000''>OK, and let''s see what it means to
  have --</span> <span m=''2803000''>-- in the different circumstances.</span> </p><p><span
  m=''2808000''>So, if delta of phi i is greater than zero,</span> <span m=''2815000''>OK,
  so if this is greater than zero, then what''s the</span> <span m=''2823000''>relationship
  between c_i hat and c_i?</span> </p><p><span m=''2831000''>This is greater than
  zero. Yeah, c_i hat is then greater</span> <span m=''2839000''>than c_i, OK? Then,
  c_i hat is greater than</span> <span m=''2845000''>c_i. And what does that mean?</span>
  </p><p><span m=''2850000''>That means when I do operation I, I charged more than
  it cost</span> <span m=''2859000''>me to do the operation. So, the extra amount
  that I</span> <span m=''2868000''>charged beyond what I actually used is being put
  into the bank,</span> <span m=''2878000''>OK, is being stored as potential energy.</span>
  </p><p><span m=''2884000''>So, op I stores work in the data structure for later.</span>
  </p><p><span m=''2895000''>Similarly, if delta phi i is less than zero,</span> <span
  m=''2902000''>then c_i hat is less than c_i. And so, the data structure</span> <span
  m=''2913000''>delivers up work --</span> <span m=''2932000''>-- to help pay for
  op I, OK, for operation I.</span> </p><p><span m=''2943000''>So, if it''s less than
  zero, that means that my change in</span> <span m=''2948000''>potential, that means
  my bank account went down as a result,</span> <span m=''2954000''>and so therefore,
  what happens was the data</span> <span m=''2958000''>structure provided work to
  be done in order,</span> <span m=''2963000''>because the true cost was bigger than
  the amortized cost.</span> </p><p><span m=''2970000''>So, if you think about it,
  the difference between looking</span> <span m=''2973000''>at it from the potential
  function point of view versus</span> <span m=''2977000''>the accounting point of
  view, the accounting point of view,</span> <span m=''2981000''>you sort of say,
  here is what my amortized cost</span> <span m=''2984000''>will be. Now let me analyze
  my bank</span> <span m=''2986000''>account, make sure it never went negative.</span>
  </p><p><span m=''2989000''>In some sense, in the potential function</span> <span
  m=''2992000''>argument, you''re saying, here''s what my bank account is</span> <span
  m=''2996000''>all the time. Now let me analyze what the</span> <span m=''3001000''>amortized
  costs are. So, that''s sort of the</span> <span m=''3006000''>difference in approaches.
  One is you are sort of</span> <span m=''3012000''>specifying the bank account. The
  other, you''re specifying</span> <span m=''3019000''>the amortized costs. So, we
  look at the,</span> <span m=''3024000''>why is it that this is a reasonable way
  to proceed?</span> </p><p><span m=''3032000''>Well, let''s look at the total amortized
  cost of n operations.</span> </p><p><span m=''3041000''>OK, that''s just the sum,
  i equals one to n of c_i hat.</span> </p><p><span m=''3049000''>That''s the total
  amortized cost.</span> </p><p><span m=''3053000''>And that''s equal to, but substitution,</span>
  <span m=''3059000''>just substitute c_i hat for this formula.</span> </p><p><span
  m=''3067000''>OK, so that''s c_i plus phi of D_i minus phi of D_i minus one.</span>
  </p><p><span m=''3084000''>OK, and that''s equal to c_i. And now, what happens when
  I</span> <span m=''3096000''>sum up these terms? What happens when some of these</span>
  <span m=''3101000''>terms? What''s the mathematical term we</span> <span m=''3105000''>use?
  It telescopes.</span> </p><p><span m=''3107000''>OK, every term on the left is added
  in once when it''s I,</span> <span m=''3113000''>and subtract it out when it''s
  I minus one, except for the first</span> <span m=''3120000''>and last terms. The
  term for n is only added</span> <span m=''3128000''>in, and the term for zero is
  only subtracted out.</span> </p><p><span m=''3136000''>OK, so that''s because it
  telescopes.</span> </p><p><span m=''3143000''>OK, so this term is what? What property
  do we know of</span> <span m=''3152000''>this? It''s greater than or equal to</span>
  <span m=''3158000''>zero. And this one equals zero.</span> </p><p><span m=''3162000''>So,
  therefore, this is greater than or equal</span> <span m=''3168000''>to c_i. And
  thus, the amortized costs</span> <span m=''3173000''>are an upper bound on the true
  costs, which is what we want.</span> </p><p><span m=''3182000''>Some of the amortized
  costs is an upper bound up on the sum of</span> <span m=''3186000''>the true costs.
  OK, but here,</span> <span m=''3188000''>the way that we define the amortized costs
  was by first</span> <span m=''3191000''>defining the potential function. OK, so
  the potential function</span> <span m=''3195000''>is sort of, as I said, the difference
  between the</span> <span m=''3199000''>accounting and the potential method is, do
  you specify the</span> <span m=''3203000''>bank account or do you specify the cost?</span>
  </p><p><span m=''3205000''>OK, do you specify the potential energy at any point,</span>
  <span m=''3209000''>or do you specify the cost at any point?</span> </p><p><span
  m=''3213000''>OK, but in any case, you get, this bound,</span> <span m=''3218000''>also
  this math is nicer math. I like telescopes.</span> </p><p><span m=''3224000''>OK,
  so the amortized costs upper bound the true costs.</span> </p><p><span m=''3231000''>OK,
  let''s do table doubling over here.</span> </p><p><span m=''3260000''>So, to analyze
  this, we have to define our</span> <span m=''3264000''>potential. OK, if anybody
  can guess this</span> <span m=''3268000''>off the top of their head, they''re better
  than I am.</span> </p><p><span m=''3275000''>I struggled with this for probably
  easily a couple hours</span> <span m=''3282000''>to get it right, OK, because I''m
  not too smart.</span> </p><p><span m=''3288000''>OK, that''s a potential function
  I''m going to use,</span> <span m=''3295000''>OK, 2i minus two to the ceiling of
  log i.</span> </p><p><span m=''3302000''>And, we''re going to assume that two to
  the ceiling of log of</span> <span m=''3307000''>zero is equal to zero, because
  that''s what it is in</span> <span m=''3313000''>the limit. For log of zero,</span>
  <span m=''3315000''>this becomes minus infinity, so, two to the minus infinity</span>
  <span m=''3321000''>is zero. So, that''s just going to be a</span> <span m=''3325000''>mathematical
  convenience. Assume that.</span> </p><p><span m=''3330000''>OK, so where did I get
  this from?</span> </p><p><span m=''3332000''>I played around. I looked at that sequence
  that</span> <span m=''3335000''>I have erased and I said, OK, because reversing,</span>
  <span m=''3338000''>there are some problems for which defining a potential</span>
  <span m=''3341000''>function is fairly easy. But, defining the amortized</span>
  <span m=''3345000''>costs is hard, OK, to define the accounting.</span> </p><p><span
  m=''3347000''>So, for this one, the accounting method is,</span> <span m=''3350000''>I
  would say, an easier method to use.</span> </p><p><span m=''3353000''>However, I''m
  going to show you that you still can do it with</span> <span m=''3357000''>potential
  method if you come up with the right potential.</span> </p><p><span m=''3362000''>So,
  intuitively, this is basically what''s left</span> <span m=''3367000''>in the bank
  account at the I''th operation because I''ve put in 2i</span> <span m=''3374000''>things
  into the bank, and I''ve subtracted out this</span> <span m=''3380000''>many, essentially,
  from table doublings,</span> <span m=''3384000''>OK, up to that point, OK?</span>
  </p><p><span m=''3387000''>So, first let''s observe, what is phi of D_0?</span>
  </p><p><span m=''3394000''>Zero. So, that''s good.</span> </p><p><span m=''3396000''>And,
  the phi of D_i is greater than or equal to zero.</span> </p><p><span m=''3403000''>Why
  is that?</span> </p><p><span m=''3418000''>Why is that?</span> </p><p><span m=''3431000''>So,
  what''s the biggest that ceiling of log i could be?</span> </p><p><span m=''3440000''>Ceiling
  of log i is either log i or log i quantity plus one,</span> <span m=''3450000''>OK?
  So, the biggest it is,</span> <span m=''3454000''>is log i plus one. If it''s log
  i plus one,</span> <span m=''3460000''>two to the log i plus one, it''s just 2i.</span>
  </p><p><span m=''3465000''>That''s the biggest it could be, right?</span> </p><p><span
  m=''3470000''>So, two, the log of i, plus one, is just,</span> <span m=''3475000''>let''s
  do it the other way, is i times two,</span> <span m=''3481000''>OK, i for that part,
  two for that part.</span> </p><p><span m=''3488000''>OK, so that the biggest it
  could be.</span> </p><p><span m=''3492000''>OK, or it''s just log of i. So, either
  this is going to be</span> <span m=''3500000''>2i minus i or 2i minus 2i. In either
  case,</span> <span m=''3505000''>it''s bigger than zero, OK?</span> </p><p><span
  m=''3510000''>So, those are the two properties I need for this to be</span> <span
  m=''3514000''>a well-defined potential function.</span> </p><p><span m=''3516000''>Now,
  that doesn''t say that the amortized costs are going to be</span> <span m=''3521000''>satisfied
  the property that things are going to be cheap,</span> <span m=''3525000''>OK, that
  I''m going to be able to do my analysis and get the</span> <span m=''3530000''>kind
  of bounds I want. But, it sets up to say,</span> <span m=''3533000''>yes, I''ve
  satisfied the syntax of having a proper potential</span> <span m=''3538000''>function.
  So, let''s just do a quick</span> <span m=''3543000''>example here just to see what
  this means.</span> </p><p><span m=''3547000''>So, imagine that I am in the situation
  where I have eight,</span> <span m=''3554000''>did I do that right, OK, yeah, eight
  slots,</span> <span m=''3559000''>and say six of them are full. So then, phi by
  this is going</span> <span m=''3566000''>to be 2i. That''s two times six minus two</span>
  <span m=''3571000''>to the 2i. What''s that?</span> </p><p><span m=''3575000''>Sorry,
  minus two to the ceiling of log i.</span> </p><p><span m=''3581000''>So, i is six,
  right, so log of i is log of</span> <span m=''3586000''>six. The ceiling of it is
  three.</span> </p><p><span m=''3590000''>So, that''s minus 2^3, which is eight.</span>
  </p><p><span m=''3595000''>So, that''s 12 minus eight. That''s four.</span> </p><p><span
  m=''3602000''>And if you think about this in the accounting method,</span> <span
  m=''3605875''>these would be zeros, and these would be twos,</span> <span m=''3609228''>right,
  for the accounting method if we do the same thing,</span> <span m=''3613401''>because
  this is halfway through, right,</span> <span m=''3616233''>all zeros, and that we
  add two for each one that we''re going</span> <span m=''3620629''>in. So, I function
  is,</span> <span m=''3622194''>in fact, telling me what the actual cost is.</span>
  </p><p><span m=''3625399''>OK, everybody with me? OK, so that''s what we mean by</span>
  <span m=''3629199''>this particular potential function.</span> </p><p><span m=''3633000''>OK,
  so now let''s add up the amortized cost of the i''th</span> <span m=''3637274''>insert.</span>
  </p><p><span m=''3669000''>OK, so that''s the amortized cost of the i''th insert,</span>
  <span m=''3674190''>just by definition. OK, and now that''s equal to,</span> <span
  m=''3678973''>well, what is c_i? Do we still have that written</span> <span m=''3683756''>down
  somewhere, or have we erased that at this</span> <span m=''3688336''>point? I think
  we erased it.</span> </p><p><span m=''3692000''>Well, we can write it down again.</span>
  </p><p><span m=''3697480''>It is i if i minus one is an exact power of two.</span>
  </p><p><span m=''3705530''>And, it''s one otherwise. That''s c_i.</span> </p><p><span
  m=''3711524''>That''s this term, plus, and now phi of D_i:</span> <span m=''3718718''>so,
  what is that? phi of D_i is this business,</span> <span m=''3730830''>2i minus two
  ceiling of log i minus 2i minus one minus two</span> <span m=''3746771''>ceiling
  of log of I minus one. OK, so that''s the amortized</span> <span m=''3759634''>cost.
  That''s a nice,</span> <span m=''3762192''>pretty formula, right?</span> </p><p><span
  m=''3765019''>OK, let''s hope it simplifies a little.</span> </p><p><span m=''3770000''>OK,
  so that''s equal to, well, we have the i and the one</span> <span m=''3777269''>here,
  if, etc., that business,</span> <span m=''3781173''>plus, OK, well, we have some
  things we can</span> <span m=''3786692''>cancel here, right? So here, we have 2i
  minus 2i.</span> </p><p><span m=''3796662''>That cancels. And then we have what''s
  left</span> <span m=''3804668''>over here is a minus two. So, that''s a plus two.</span>
  </p><p><span m=''3813846''>And now, I have minus this term plus this term.</span>
  </p><p><span m=''3824000''>That''s a lot prettier. OK, it''s still a mess.</span>
  </p><p><span m=''3828049''>We''ve got to case analysis. Why is it suggestive of
  a case</span> <span m=''3833294''>analysis? We have a case.</span> </p><p><span
  m=''3835503''>OK, so let''s do a case analysis.</span> </p><p><span m=''3851000''>OK,
  so case one, I minus one is an exact power</span> <span m=''3857966''>of two. So
  then, c_i hat is equal to,</span> <span m=''3863538''>well, c_i is now just i. That''s
  that case.</span> </p><p><span m=''3869887''>And then we have the rest there, plus
  two,</span> <span m=''3876234''>minus two, ceiling of log i minus two ceiling of
  log of i</span> <span m=''3884903''>minus one. OK, and that''s equal to i plus</span>
  <span m=''3893089''>two. Well, let''s see.</span> </p><p><span m=''3896482''>If
  I minus one is an exact power of two,</span> <span m=''3903098''>what is this term?
  i minus one is an exact power</span> <span m=''3912236''>of two. Plus, thank you,</span>
  <span m=''3916388''>sorry about that.</span> </p><p><span m=''3933000''>It''s good
  to have students, let me say, because,</span> <span m=''3936916''>boy, my math is
  so bad. This is actually why I end up</span> <span m=''3941250''>being a pretty
  good theoretician is because I don''t ever trust</span> <span m=''3946333''>what
  I''ve written down. And so, I write it down in a</span> <span m=''3950583''>way
  that I can verify it because otherwise I just am not smart</span> <span m=''3955666''>enough
  to carry through five equations in a row and expect</span> <span m=''3960416''>that
  everyone is going to be transformed appropriately.</span> </p><p><span m=''3966000''>OK,
  so you write it down. So I always write it down so I</span> <span m=''3971529''>can
  verify it. And that fortunately has the</span> <span m=''3975754''>side benefit
  that other people can understand what I''ve done as</span> <span m=''3981988''>well.
  OK, so what is this one?</span> </p><p><span m=''3984904''>This is two to the log
  of i minus one because the ceiling,</span> <span m=''3990636''>if this is an exact
  power of two, right, then ceiling of log</span> <span m=''3996569''>of i minus one
  is just log of i minus one.</span> </p><p><span m=''4002000''>So, this is two to
  the log of i minus one, which is i minus one,</span> <span m=''4012013''>right?
  Yeah?</span> </p><p><span m=''4013761''>OK. OK, if it''s an exact power of</span>
  <span m=''4018846''>two, then the log is an integer, right?</span> </p><p><span
  m=''4026000''>So, taking the ceiling, it doesn''t matter,</span> <span m=''4029713''>get
  rid of the ceiling. OK, this one,</span> <span m=''4032973''>however, is not an
  exact power of two.</span> </p><p><span m=''4036324''>But what is it? It''s just
  one more than this</span> <span m=''4040218''>guy. We know that i minus one is not</span>
  <span m=''4043388''>an exact power of two, so it''s going to be the next</span>
  <span m=''4047916''>bigger one. OK, so that means this is what?</span> </p><p><span
  m=''4056053''>So, it''s going to be, how do these two compare?</span> </p><p><span
  m=''4065035''>How much bigger is this one than this one?</span> </p><p><span m=''4073041''>It''s
  twice the size. We know what this one is.</span> </p><p><span m=''4083000''>OK,
  or it can reason it from first principles.</span> </p><p><span m=''4086656''>This
  is going to be the log of i minus one plus one.</span> </p><p><span m=''4090800''>OK,
  and so then you can reduce it to this.</span> </p><p><span m=''4094131''>So, you''ve
  got to think about those floors and ceilings,</span> <span m=''4098600''>right?
  It''s like, what''s happening in</span> <span m=''4101524''>the round off there?
  OK, so now we can simplify</span> <span m=''4105261''>this. OK, so what do we have
  here?</span> </p><p><span m=''4109000''>We have, OK, so if I multiply this through,</span>
  <span m=''4114136''>I have an i plus two minus 2i plus two plus i minus one.</span>
  </p><p><span m=''4120863''>I know a lot of you, probably 90% of you will do</span>
  <span m=''4126611''>this step. You will go directly from this</span> <span m=''4131502''>step
  to the last step. And that''s where 30% of you,</span> <span m=''4137618''>or some
  number, will get it wrong.</span> </p><p><span m=''4143000''>OK, so let me encourage
  you to do that step.</span> </p><p><span m=''4146818''>OK, it''s easier to find
  your bugs if you take it slow.</span> </p><p><span m=''4151526''>Actually, taking
  it slow is faster in the long run.</span> </p><p><span m=''4155966''>It''s hard
  to teach young stallions, or phillies,</span> <span m=''4160140''>or whatever, OK?</span>
  </p><p><span m=''4161473''>Just take it easy. Just patience,</span> <span m=''4164315''>just
  do it slow, get it right.</span> </p><p><span m=''4166890''>It''s actually faster.
  OK, everybody knows the</span> <span m=''4172670''>tortoise and hare story. Yeah,
  yeah, yeah,</span> <span m=''4177432''>OK, but nobody believes it. OK, so now here
  we have 2i</span> <span m=''4183586''>here, an i here, and an i here.</span> </p><p><span
  m=''4187069''>And then, that leaves us with two plus two minus one,</span> <span
  m=''4193109''>equals three. Awesome, awesome.</span> </p><p><span m=''4196593''>OK,
  amortized cost is three when i minus one is an exact</span> <span m=''4202980''>power
  of two. OK, case two.</span> </p><p><span m=''4230000''>OK, i minus one is not an
  exact power of two.</span> </p><p><span m=''4234829''>So then we have c_i hat is
  equal to, now instead of i it''s</span> <span m=''4241085''>one plus, and then the
  two minus two to the ceiling of log i plus</span> <span m=''4248109''>two to the
  ceiling of log of i minus one.</span> </p><p><span m=''4252500''>OK, now what can
  somebody tell me about these two terms in the</span> <span m=''4259195''>case where
  i minus one is not an exact power of two?</span> </p><p><span m=''4266000''>What
  are they? Equal.</span> </p><p><span m=''4269216''>Why is that? Yeah, the ceiling
  is going to</span> <span m=''4275809''>do the same thing to both, going to take
  it up to the same</span> <span m=''4284974''>integer. So these two things are equal,</span>
  <span m=''4291085''>which means this is equal to three.</span> </p><p><span m=''4298000''>OK,
  so therefore, n inserts, OK,</span> <span m=''4302405''>so now I say, oh, the amortized
  cost is three</span> <span m=''4308657''>for every operation for every insert.</span>
  </p><p><span m=''4313773''>So therefore, n inserts costs,</span> <span m=''4317894''>well,
  the amortized cost of each is three.</span> </p><p><span m=''4325000''>So n of them,
  the amortized cost is 3n.</span> </p><p><span m=''4328986''>That''s an upper bound
  on the worst-case true costs.</span> </p><p><span m=''4334230''>So, n inserts costs
  order n in the worst case.</span> </p><p><span m=''4338951''>OK, there is a bug
  in this analysis.</span> </p><p><span m=''4342622''>It''s a minor bug. It''s the
  one I pointed out</span> <span m=''4347132''>before the first insert has amortized
  cost of two,</span> <span m=''4352272''>and not three. I didn''t actually deal with</span>
  <span m=''4357182''>that one carefully enough. OK, so that''s an exercise to</span>
  <span m=''4361547''>just go and look to see where it is that that happens and how
  you</span> <span m=''4366721''>show that, in fact, the amortized cost of the first</span>
  <span m=''4370763''>one is two, OK, where that shows up.</span> </p><p><span m=''4373592''>OK,
  so to summarize, actually let me summarize over</span> <span m=''4377634''>here,
  conclusions about amortized analysis.</span> </p><p><span m=''4397000''>So amortized
  costs provide a clean abstraction for data</span> <span m=''4415000''>structure
  performance. So, what I can tell somebody,</span> <span m=''4425556''>so suppose
  I built a dynamic table, for example,</span> <span m=''4429699''>OK. It''s easier
  to say,</span> <span m=''4431638''>in terms of your own performance modeling,</span>
  <span m=''4435252''>it costs a constant amount of time for each insert.</span> </p><p><span
  m=''4439659''>As long as you don''t care about real-time behavior,</span> <span
  m=''4444066''>but only the aggregate behavior, that''s a great</span> <span m=''4448121''>abstraction
  for the performance Rather than saying it''s got</span> <span m=''4454156''>that
  complicated thing which sometimes cost you a lot,</span> <span m=''4458390''>how
  do they reason about that? But you could say every</span> <span m=''4462624''>operation
  costs me order one, that''s really simple.</span> </p><p><span m=''4466618''>But
  they have to understand, it''s order one in an amortized</span> <span m=''4471251''>sense,
  OK. So, if they do have a real-time</span> <span m=''4474526''>constraint to make,
  amortized doesn''t cut it.</span> </p><p><span m=''4479000''>OK, but for many problems,
  it''s perfectly good.</span> </p><p><span m=''4482159''>It lets me explain it rather
  simply.</span> </p><p><span m=''4484563''>OK, we will see some other data structures
  that have amortized</span> <span m=''4488752''>costs where different operations
  have different amortized costs.</span> </p><p><span m=''4493079''>And the nice thing
  about that is I just add up,</span> <span m=''4496239''>what''s the cost of all
  my different operations,</span> <span m=''4499398''>OK, where there is a different
  cost for each operation?</span> </p><p><span m=''4504000''>Some will be log n. Some
  will be order one,</span> <span m=''4507068''>or whatever. Add them up:</span> <span
  m=''4508822''>that''s an upper bound on the true costs.</span> </p><p><span m=''4511672''>OK:
  tremendous simplification in abstracting and reasoning</span> <span m=''4515837''>about
  those complicated data structures.</span> </p><p><span m=''4518686''>OK, now, so
  this is probably, this is huge.</span> </p><p><span m=''4521755''>OK, abstraction,
  you know, computer science,</span> <span m=''4524897''>what teach you through four
  years of undergraduate,</span> <span m=''4528551''>and another year if you go on
  to M.Eng., and then if you get a</span> <span m=''4533008''>Ph.D., it''s another
  15 years or whatever it takes to get a Ph.D.</span> </p><p><span m=''4539000''>OK,
  all you teach about is abstraction: abstraction,</span> <span m=''4544392''>abstraction,
  abstraction.</span> </p><p><span m=''4546929''>So, this is a powerful abstraction:
  quite good.</span> </p><p><span m=''4551792''>Now, we learned three methods. In
  general, any method can be</span> <span m=''4558030''>used. You can convert one
  to the</span> <span m=''4561308''>other. But each has situations where</span> <span
  m=''4570386''>it is arguably simplest or most precise.</span> </p><p><span m=''4580320''>So,
  any of the methods can be used.</span> </p><p><span m=''4590000''>However, you must
  learn all of them, OK, because there are</span> <span m=''4594299''>going to be
  some situations where you need one,</span> <span m=''4597768''>where it''s better
  to do one, better to do another.</span> </p><p><span m=''4601464''>If you''re reading
  in the literature, you want to know</span> <span m=''4605386''>these different ways
  of doing it.</span> </p><p><span m=''4607800''>And that means that even though you
  may get really comfortable</span> <span m=''4612401''>with accounting, OK, in an
  exam,</span> <span m=''4614739''>or whatever, I may say solve this with a</span>
  <span m=''4617681''>potential function argument. So, you want to be comfortable</span>
  <span m=''4627441''>with all the methods, OK.</span> </p><p><span m=''4632595''>Last
  point is that, in fact, different potential</span> <span m=''4642687''>functions
  or accounting costs may yield different bounds.</span> </p><p><span m=''4656000''>OK,
  so when you do an amortized analysis, there''s nothing to say</span> <span m=''4661628''>that
  one set of costs is better than another.</span> </p><p><span m=''4665559''>So, just
  as an example, OK, in any data structure</span> <span m=''4669847''>generally that
  supports delete, I can amortize all the deletes</span> <span m=''4675296''>against
  the inserts. So, in general,</span> <span m=''4678423''>what I could do is say deletes
  are free, OK,</span> <span m=''4682265''>and charge twice as much for each insert.</span>
  </p><p><span m=''4687000''>OK, charging enough when I do the insert to amortize
  it</span> <span m=''4690338''>against the delete. That you could do with an</span>
  <span m=''4693059''>accounting method. You can also do it with a</span> <span m=''4695717''>potential
  method, the potential,</span> <span m=''4697634''>then, being the number of items
  that I actually have in my data</span> <span m=''4701467''>structure times the cost
  of the delete for each of those items.</span> </p><p><span m=''4705300''>OK, so
  the point is that I can allocate costs in different</span> <span m=''4708825''>ways.
  Or I could have amortized costs</span> <span m=''4711919''>which are equal to the
  true costs.</span> </p><p><span m=''4713962''>So, there are different ways that
  I could assign amortized</span> <span m=''4717491''>costs. There is no one way,</span>
  <span m=''4719101''>OK, and choosing different ones may yield different bounds.</span>
  </p><p><span m=''4722692''>It may not, but it may yield different bounds.</span>
  </p><p><span m=''4725478''>OK, generally it does yield different ones.</span> </p><p><span
  m=''4728079''>OK, next time: an amazing use of potential</span> <span m=''4730617''>functions.
  OK, the stuff is cool,</span> <span m=''4732598''>but let me tell you, Wednesday''s
  lecture:</span> <span m=''4735075''>amazing. Amazing the type of analysis we</span>
  <span m=''4737490''>are going to be able to do.</span> </p>'
type: course
uid: 507f17473d5c03b93a67e5ce66f3066d

---
None